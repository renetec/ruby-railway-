<!-- Entreprises - 2 Column Layout -->
<div class="max-w-6xl mx-auto px-4 py-8">
  <!-- Page Header with Logo -->
  <%= render 'shared/page_header_with_logo', 
      title: "Annuaire des Entreprises",
      subtitle: "DÃ©couvrez les entreprises locales de votre rÃ©gion" %>

  <!-- Action Buttons -->
  <% if user_signed_in? %>
    <div class="flex flex-col sm:flex-row gap-4 mb-8 justify-center">
      <%= link_to "ğŸ¢ #{t('actions.add_business')}", new_business_path, 
                  class: "px-6 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-semibold" %>
      <%= link_to "ğŸ“Š Mes entreprises", my_businesses_businesses_path, 
                  class: "px-6 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg font-semibold" %>
    </div>
  <% end %>

  <!-- Filters Section -->
  <div class="flex flex-col md:flex-row gap-4 mb-8 justify-center">
    <select class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
      <option>Secteur d'activitÃ©</option>
      <option>Restaurants</option>
      <option>Services</option>
      <option>Commerce</option>
      <option>Artisanat</option>
      <option>Technologie</option>
    </select>
    <select class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
      <option>Localisation</option>
      <option>Centre-ville</option>
      <option>Zone industrielle</option>
      <option>Banlieue</option>
    </select>
    <button class="px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 dark:bg-blue-600 dark:hover:bg-blue-700">
      ğŸ”„ Actualiser
    </button>
  </div>

  <!-- 2-Column Businesses Grid -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <!-- Business 1 -->
    <div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer" onclick="openModal('modal-1')">
      <div class="flex gap-4">
        <div class="w-24 h-24 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center flex-shrink-0">
          <span class="text-3xl">ğŸ•</span>
        </div>
        <div class="flex-1">
          <div class="flex justify-between items-start mb-2">
            <span class="bg-orange-500 text-white px-2 py-1 rounded text-xs">Restaurant</span>
            <div class="flex items-center">
              <span class="text-yellow-500">â˜…</span>
              <span class="text-sm text-gray-500 dark:text-gray-400 ml-1">4.5 (28)</span>
            </div>
          </div>
          <h3 class="font-bold text-lg mb-1 text-gray-900 dark:text-gray-100">Pizzeria Bella Vista</h3>
          <p class="text-gray-600 dark:text-gray-400 text-sm mb-2">Pizzas authentiques au feu de bois, ambiance familiale...</p>
          <div class="flex justify-between items-center">
            <span class="text-xs text-gray-500 dark:text-gray-400">ğŸ“ Centre-ville</span>
            <button class="text-blue-600 hover:text-blue-800 text-sm font-medium" onclick="event.stopPropagation(); openModal('modal-1')">
              ğŸ“ Contacter
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Business 2 -->
    <div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer" onclick="openModal('modal-2')">
      <div class="flex gap-4">
        <div class="w-24 h-24 bg-green-100 dark:bg-green-900 rounded-lg flex items-center justify-center flex-shrink-0">
          <span class="text-3xl">ğŸ”§</span>
        </div>
        <div class="flex-1">
          <div class="flex justify-between items-start mb-2">
            <span class="bg-green-500 text-white px-2 py-1 rounded text-xs">Services</span>
            <div class="flex items-center">
              <span class="text-yellow-500">â˜…</span>
              <span class="text-sm text-gray-500 dark:text-gray-400 ml-1">4.8 (15)</span>
            </div>
          </div>
          <h3 class="font-bold text-lg mb-1 text-gray-900 dark:text-gray-100">Garage Auto Plus</h3>
          <p class="text-gray-600 dark:text-gray-400 text-sm mb-2">RÃ©paration automobile, entretien, diagnostic Ã©lectronique...</p>
          <div class="flex justify-between items-center">
            <span class="text-xs text-gray-500 dark:text-gray-400">ğŸ“ Zone industrielle</span>
            <button class="text-blue-600 hover:text-blue-800 text-sm font-medium" onclick="event.stopPropagation(); openModal('modal-2')">
              ğŸ“ Contacter
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Business 3 -->
    <div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer" onclick="openModal('modal-3')">
      <div class="flex gap-4">
        <div class="w-24 h-24 bg-purple-100 dark:bg-purple-900 rounded-lg flex items-center justify-center flex-shrink-0">
          <span class="text-3xl">ğŸ’„</span>
        </div>
        <div class="flex-1">
          <div class="flex justify-between items-start mb-2">
            <span class="bg-purple-500 text-white px-2 py-1 rounded text-xs">BeautÃ©</span>
            <div class="flex items-center">
              <span class="text-yellow-500">â˜…</span>
              <span class="text-sm text-gray-500 dark:text-gray-400 ml-1">4.9 (42)</span>
            </div>
          </div>
          <h3 class="font-bold text-lg mb-1 text-gray-900 dark:text-gray-100">Salon Ã‰lÃ©gance</h3>
          <p class="text-gray-600 dark:text-gray-400 text-sm mb-2">Coiffure, soins esthÃ©tiques, manucure dans un cadre moderne...</p>
          <div class="flex justify-between items-center">
            <span class="text-xs text-gray-500 dark:text-gray-400">ğŸ“ Centre-ville</span>
            <button class="text-blue-600 hover:text-blue-800 text-sm font-medium" onclick="event.stopPropagation(); openModal('modal-3')">
              ğŸ“ Contacter
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Business 4 -->
    <div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer" onclick="openModal('modal-4')">
      <div class="flex gap-4">
        <div class="w-24 h-24 bg-red-100 dark:bg-red-900 rounded-lg flex items-center justify-center flex-shrink-0">
          <span class="text-3xl">ğŸ¥–</span>
        </div>
        <div class="flex-1">
          <div class="flex justify-between items-start mb-2">
            <span class="bg-red-500 text-white px-2 py-1 rounded text-xs">Boulangerie</span>
            <div class="flex items-center">
              <span class="text-yellow-500">â˜…</span>
              <span class="text-sm text-gray-500 dark:text-gray-400 ml-1">4.7 (35)</span>
            </div>
          </div>
          <h3 class="font-bold text-lg mb-1 text-gray-900 dark:text-gray-100">Boulangerie du Coin</h3>
          <p class="text-gray-600 dark:text-gray-400 text-sm mb-2">Pain frais, viennoiseries, pÃ¢tisseries artisanales...</p>
          <div class="flex justify-between items-center">
            <span class="text-xs text-gray-500 dark:text-gray-400">ğŸ“ Quartier rÃ©sidentiel</span>
            <button class="text-blue-600 hover:text-blue-800 text-sm font-medium" onclick="event.stopPropagation(); openModal('modal-4')">
              ğŸ“ Contacter
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Business 5 -->
    <div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer" onclick="openModal('modal-5')">
      <div class="flex gap-4">
        <div class="w-24 h-24 bg-yellow-100 dark:bg-yellow-900 rounded-lg flex items-center justify-center flex-shrink-0">
          <span class="text-3xl">ğŸ’»</span>
        </div>
        <div class="flex-1">
          <div class="flex justify-between items-start mb-2">
            <span class="bg-yellow-500 text-white px-2 py-1 rounded text-xs">Informatique</span>
            <div class="flex items-center">
              <span class="text-yellow-500">â˜…</span>
              <span class="text-sm text-gray-500 dark:text-gray-400 ml-1">4.6 (22)</span>
            </div>
          </div>
          <h3 class="font-bold text-lg mb-1 text-gray-900 dark:text-gray-100">Tech Solutions</h3>
          <p class="text-gray-600 dark:text-gray-400 text-sm mb-2">DÃ©pannage informatique, dÃ©veloppement web, formation...</p>
          <div class="flex justify-between items-center">
            <span class="text-xs text-gray-500 dark:text-gray-400">ğŸ“ Centre d'affaires</span>
            <button class="text-blue-600 hover:text-blue-800 text-sm font-medium" onclick="event.stopPropagation(); openModal('modal-5')">
              ğŸ“ Contacter
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Business 6 -->
    <div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer" onclick="openModal('modal-6')">
      <div class="flex gap-4">
        <div class="w-24 h-24 bg-indigo-100 dark:bg-indigo-900 rounded-lg flex items-center justify-center flex-shrink-0">
          <span class="text-3xl">ğŸŒ¸</span>
        </div>
        <div class="flex-1">
          <div class="flex justify-between items-start mb-2">
            <span class="bg-indigo-500 text-white px-2 py-1 rounded text-xs">Fleuriste</span>
            <div class="flex items-center">
              <span class="text-yellow-500">â˜…</span>
              <span class="text-sm text-gray-500 dark:text-gray-400 ml-1">4.8 (18)</span>
            </div>
          </div>
          <h3 class="font-bold text-lg mb-1 text-gray-900 dark:text-gray-100">Fleurs & Jardins</h3>
          <p class="text-gray-600 dark:text-gray-400 text-sm mb-2">Compositions florales, plantes d'intÃ©rieur, conseils jardinage...</p>
          <div class="flex justify-between items-center">
            <span class="text-xs text-gray-500 dark:text-gray-400">ğŸ“ Centre-ville</span>
            <button class="text-blue-600 hover:text-blue-800 text-sm font-medium" onclick="event.stopPropagation(); openModal('modal-6')">
              ğŸ“ Contacter
            </button>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- Detail Modal -->
<div id="detail-modal" class="fixed inset-0 z-50 hidden items-center justify-center bg-black bg-opacity-50">
  <div class="bg-white dark:bg-gray-800 max-w-2xl w-full mx-4 rounded-lg overflow-hidden max-h-[80vh] overflow-y-auto">
    <div class="p-6">
      <!-- Modal Header -->
      <div class="flex justify-between items-start mb-6">
        <div id="modal-category" class="bg-blue-500 text-white px-4 py-2 rounded-full text-sm font-medium"></div>
        <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 text-2xl font-bold">Ã—</button>
      </div>
      
      <!-- Modal Content -->
      <div class="flex gap-6 mb-6">
        <div id="modal-image" class="w-32 h-32 bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center flex-shrink-0">
          <span id="modal-emoji" class="text-4xl"></span>
        </div>
        <div class="flex-1">
          <h2 id="modal-title" class="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-4"></h2>
          <div class="flex items-center mb-3">
            <div id="modal-rating" class="flex items-center text-yellow-500 mr-4">
              <span>â˜…</span>
              <span id="modal-rating-text" class="text-gray-600 dark:text-gray-400 ml-1"></span>
            </div>
            <span id="modal-location" class="text-gray-600 dark:text-gray-400 text-sm"></span>
          </div>
          <p id="modal-description" class="text-gray-600 dark:text-gray-400 mb-4"></p>
          <div id="modal-contact" class="space-y-2"></div>
        </div>
      </div>
      
      <!-- Contact Form -->
      <div class="border-t dark:border-gray-600 pt-6">
        <h3 class="text-lg font-bold text-gray-900 dark:text-gray-100 mb-4">Contacter l'entreprise</h3>
        <form class="space-y-4" onsubmit="handleContactSubmit(event)">
          <div>
            <label class="block text-gray-700 dark:text-gray-300 font-medium mb-2">Votre nom</label>
            <input type="text" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-lg focus:border-blue-500 focus:outline-none" placeholder="Votre nom complet" required>
          </div>
          <div>
            <label class="block text-gray-700 dark:text-gray-300 font-medium mb-2">Sujet</label>
            <select class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-lg focus:border-blue-500 focus:outline-none" required>
              <option>Demande d'information</option>
              <option>Prise de rendez-vous</option>
              <option>Devis</option>
              <option>RÃ©clamation</option>
              <option>Autre</option>
            </select>
          </div>
          <div>
            <label class="block text-gray-700 dark:text-gray-300 font-medium mb-2">Message</label>
            <textarea rows="4" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-lg focus:border-blue-500 focus:outline-none resize-none" placeholder="Votre message..." required></textarea>
          </div>
          <div class="flex gap-4 pt-4">
            <button type="submit" class="bg-blue-500 hover:bg-blue-600 text-white flex-1 py-3 px-6 rounded-lg font-semibold">
              ğŸ“¤ <%= t('actions.send_message') %>
            </button>
            <button type="button" onclick="closeModal()" class="bg-gray-500 hover:bg-gray-600 text-white py-3 px-6 rounded-lg font-semibold">
              <%= t('actions.close') %>
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<script>
// Modal data for businesses
const modalData = {
  'modal-1': {
    category: 'Restaurant',
    title: 'Pizzeria Bella Vista',
    rating: '4.5 (28 avis)',
    location: 'ğŸ“ Centre-ville - 15 Rue de la Paix',
    emoji: 'ğŸ•',
    description: 'Pizzeria familiale proposant des pizzas authentiques cuites au feu de bois. Ambiance chaleureuse, ingrÃ©dients frais et recettes traditionnelles italiennes. Terrasse ouverte en saison.',
    contact: [
      'ğŸ“ 05 12 34 56 78',
      'ğŸ“§ contact@bellavista.fr',
      'ğŸŒ www.bellavista-pizzeria.fr',
      'ğŸ•’ Mar-Dim 11h30-14h / 18h30-22h30'
    ]
  },
  'modal-2': {
    category: 'Services',
    title: 'Garage Auto Plus',
    rating: '4.8 (15 avis)',
    location: 'ğŸ“ Zone industrielle - 42 Avenue des Artisans',
    emoji: 'ğŸ”§',
    description: 'Garage automobile spÃ©cialisÃ© dans la rÃ©paration toutes marques, l\'entretien pÃ©riodique et le diagnostic Ã©lectronique. Ã‰quipe qualifiÃ©e, matÃ©riel moderne, devis gratuit.',
    contact: [
      'ğŸ“ 05 98 76 54 32',
      'ğŸ“§ info@garageautoplus.fr',
      'ğŸŒ www.garage-autoplus.com',
      'ğŸ•’ Lun-Ven 8h-18h / Sam 8h-12h'
    ]
  },
  'modal-3': {
    category: 'BeautÃ©',
    title: 'Salon Ã‰lÃ©gance',
    rating: '4.9 (42 avis)',
    location: 'ğŸ“ Centre-ville - 8 Place du MarchÃ©',
    emoji: 'ğŸ’„',
    description: 'Salon de coiffure et institut de beautÃ© dans un cadre moderne et relaxant. Services : coiffure dame/homme, soins esthÃ©tiques, manucure, maquillage. Produits haut de gamme.',
    contact: [
      'ğŸ“ 05 45 67 89 12',
      'ğŸ“§ rdv@salon-elegance.fr',
      'ğŸŒ www.salon-elegance.com',
      'ğŸ•’ Mar-Sam 9h-19h'
    ]
  },
  'modal-4': {
    category: 'Boulangerie',
    title: 'Boulangerie du Coin',
    rating: '4.7 (35 avis)',
    location: 'ğŸ“ Quartier rÃ©sidentiel - 25 Rue des Lilas',
    emoji: 'ğŸ¥–',
    description: 'Boulangerie artisanale proposant pains frais, viennoiseries maison et pÃ¢tisseries traditionnelles. SpÃ©cialitÃ©s : pain de campagne, croissants au beurre, tartes aux fruits de saison.',
    contact: [
      'ğŸ“ 05 23 45 67 89',
      'ğŸ“§ boulangerie.coin@gmail.com',
      'ğŸ•’ Mar-Dim 6h30-19h30'
    ]
  },
  'modal-5': {
    category: 'Informatique',
    title: 'Tech Solutions',
    rating: '4.6 (22 avis)',
    location: 'ğŸ“ Centre d\'affaires - 12 Boulevard Innovation',
    emoji: 'ğŸ’»',
    description: 'SociÃ©tÃ© de services informatiques : dÃ©pannage, maintenance, dÃ©veloppement web, formation. Intervention rapide, support technique, solutions sur mesure pour particuliers et entreprises.',
    contact: [
      'ğŸ“ 05 67 89 12 34',
      'ğŸ“§ contact@tech-solutions.fr',
      'ğŸŒ www.tech-solutions-pro.com',
      'ğŸ•’ Lun-Ven 8h30-18h / DÃ©pannage 24h/7j'
    ]
  },
  'modal-6': {
    category: 'Fleuriste',
    title: 'Fleurs & Jardins',
    rating: '4.8 (18 avis)',
    location: 'ğŸ“ Centre-ville - 33 Rue des Jardins',
    emoji: 'ğŸŒ¸',
    description: 'Fleuriste crÃ©ateur proposant compositions florales, plantes d\'intÃ©rieur et d\'extÃ©rieur, conseils jardinage. Livraison possible, service Ã©vÃ©nementiel (mariages, obsÃ¨ques).',
    contact: [
      'ğŸ“ 05 34 56 78 90',
      'ğŸ“§ fleurs.jardins@orange.fr',
      'ğŸŒ www.fleurs-et-jardins.fr',
      'ğŸ•’ Mar-Sam 8h30-19h / Dim 9h-12h'
    ]
  }
};

// Modal functions
function openModal(modalId) {
  const data = modalData[modalId];
  if (data) {
    document.getElementById('modal-category').textContent = data.category;
    document.getElementById('modal-title').textContent = data.title;
    document.getElementById('modal-rating-text').textContent = data.rating;
    document.getElementById('modal-location').textContent = data.location;
    document.getElementById('modal-emoji').textContent = data.emoji;
    document.getElementById('modal-description').textContent = data.description;
    
    // Set contact info
    const contactDiv = document.getElementById('modal-contact');
    contactDiv.innerHTML = data.contact.map(info => 
      `<div class="text-gray-600 dark:text-gray-400 text-sm">${info}</div>`
    ).join('');
    
    // Set category color based on type
    const categoryElement = document.getElementById('modal-category');
    const categoryColors = {
      'Restaurant': 'bg-orange-500',
      'Services': 'bg-green-500',
      'BeautÃ©': 'bg-purple-500',
      'Boulangerie': 'bg-red-500',
      'Informatique': 'bg-yellow-500',
      'Fleuriste': 'bg-indigo-500'
    };
    
    // Reset classes and add appropriate color
    categoryElement.className = `text-white px-4 py-2 rounded-full text-sm font-medium ${categoryColors[data.category] || 'bg-blue-500'}`;
    
    document.getElementById('detail-modal').style.display = 'flex';
    document.getElementById('detail-modal').classList.remove('hidden');
  }
}

function closeModal() {
  document.getElementById('detail-modal').style.display = 'none';
  document.getElementById('detail-modal').classList.add('hidden');
}

function handleContactSubmit(event) {
  event.preventDefault();
  alert('Message envoyÃ©! L\'entreprise vous rÃ©pondra rapidement.');
  closeModal();
}

// Close modal when clicking outside
document.getElementById('detail-modal').addEventListener('click', function(e) {
  if (e.target === document.getElementById('detail-modal')) {
    closeModal();
  }
});
</script>