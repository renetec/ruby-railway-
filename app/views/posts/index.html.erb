<!-- Actualit√©s - 2 Column Layout -->
<div class="max-w-6xl mx-auto px-4 py-8">
  <!-- Page Header with Logo -->
  <%= render 'shared/page_header_with_logo', 
      title: t('posts.latest_stories'),
      subtitle: t('posts.subtitle') %>

  <!-- Action Buttons -->
  <% if user_signed_in? %>
    <div class="flex flex-col sm:flex-row gap-4 mb-8 justify-center">
      <%= link_to "‚úçÔ∏è #{t('actions.publish_article')}", new_post_path, 
                  class: "px-6 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-semibold" %>
    </div>
  <% end %>

  <!-- Filters Section -->
  <div class="flex flex-col md:flex-row gap-4 mb-8 justify-center">
    <select class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
      <option><%= t('dropdowns.category') %></option>
      <option><%= t('dropdowns.local_news') %></option>
      <option><%= t('events.title') %></option>
      <option><%= t('dropdowns.practical_life') %></option>
      <option><%= t('dropdowns.culture') %></option>
      <option><%= t('dropdowns.sports') %></option>
    </select>
    <input type="text" placeholder="<%= t('actions.search_placeholder') %>" class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100">
    <button class="px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 dark:bg-blue-600 dark:hover:bg-blue-700">
      üîÑ <%= t('actions.refresh') %>
    </button>
  </div>

  <!-- 2-Column Posts Grid -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <!-- Post 1 -->
    <div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer" onclick="openModal('modal-1')">
      <div class="flex gap-4">
        <div class="w-24 h-24 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center flex-shrink-0">
          <span class="text-3xl">üèõÔ∏è</span>
        </div>
        <div class="flex-1">
          <div class="flex justify-between items-start mb-2">
            <span class="bg-blue-500 text-white px-2 py-1 rounded text-xs">Actualit√©s</span>
            <span class="text-sm text-gray-500 dark:text-gray-400">Il y a 3h</span>
          </div>
          <h3 class="font-bold text-lg mb-1 text-gray-900 dark:text-gray-100">R√©novation de la Place Centrale</h3>
          <p class="text-gray-600 dark:text-gray-400 text-sm mb-2">Les travaux de r√©am√©nagement commenceront lundi prochain...</p>
          <div class="flex justify-between items-center">
            <span class="text-xs text-gray-500 dark:text-gray-400">Par Mairie Locale</span>
            <button class="text-blue-600 hover:text-blue-800 text-sm font-medium" onclick="event.stopPropagation(); openModal('modal-1')">
              üìñ Lire plus
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Post 2 -->
    <div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer" onclick="openModal('modal-2')">
      <div class="flex gap-4">
        <div class="w-24 h-24 bg-green-100 dark:bg-green-900 rounded-lg flex items-center justify-center flex-shrink-0">
          <span class="text-3xl">üå±</span>
        </div>
        <div class="flex-1">
          <div class="flex justify-between items-start mb-2">
            <span class="bg-green-500 text-white px-2 py-1 rounded text-xs">Environnement</span>
            <span class="text-sm text-gray-500 dark:text-gray-400">Il y a 5h</span>
          </div>
          <h3 class="font-bold text-lg mb-1 text-gray-900 dark:text-gray-100">Nouveau Parc √âcologique Inaugur√©</h3>
          <p class="text-gray-600 dark:text-gray-400 text-sm mb-2">Un espace vert de 3 hectares ouvre ses portes au public...</p>
          <div class="flex justify-between items-center">
            <span class="text-xs text-gray-500 dark:text-gray-400">Par Eco Reporter</span>
            <button class="text-blue-600 hover:text-blue-800 text-sm font-medium" onclick="event.stopPropagation(); openModal('modal-2')">
              üìñ Lire plus
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Post 3 -->
    <div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer" onclick="openModal('modal-3')">
      <div class="flex gap-4">
        <div class="w-24 h-24 bg-purple-100 dark:bg-purple-900 rounded-lg flex items-center justify-center flex-shrink-0">
          <span class="text-3xl">üé≠</span>
        </div>
        <div class="flex-1">
          <div class="flex justify-between items-start mb-2">
            <span class="bg-purple-500 text-white px-2 py-1 rounded text-xs">Culture</span>
            <span class="text-sm text-gray-500 dark:text-gray-400">Il y a 8h</span>
          </div>
          <h3 class="font-bold text-lg mb-1 text-gray-900 dark:text-gray-100">Festival de Th√©√¢tre ce Weekend</h3>
          <p class="text-gray-600 dark:text-gray-400 text-sm mb-2">Cinq troupes locales pr√©senteront leurs spectacles...</p>
          <div class="flex justify-between items-center">
            <span class="text-xs text-gray-500 dark:text-gray-400">Par Culture Mag</span>
            <button class="text-blue-600 hover:text-blue-800 text-sm font-medium" onclick="event.stopPropagation(); openModal('modal-3')">
              üìñ Lire plus
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Post 4 -->
    <div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer" onclick="openModal('modal-4')">
      <div class="flex gap-4">
        <div class="w-24 h-24 bg-red-100 dark:bg-red-900 rounded-lg flex items-center justify-center flex-shrink-0">
          <span class="text-3xl">‚öΩ</span>
        </div>
        <div class="flex-1">
          <div class="flex justify-between items-start mb-2">
            <span class="bg-red-500 text-white px-2 py-1 rounded text-xs">Sports</span>
            <span class="text-sm text-gray-500 dark:text-gray-400">Il y a 12h</span>
          </div>
          <h3 class="font-bold text-lg mb-1 text-gray-900 dark:text-gray-100">Victoire de l'√âquipe Locale</h3>
          <p class="text-gray-600 dark:text-gray-400 text-sm mb-2">Le FC Local remporte le championnat d√©partemental...</p>
          <div class="flex justify-between items-center">
            <span class="text-xs text-gray-500 dark:text-gray-400">Par Sports News</span>
            <button class="text-blue-600 hover:text-blue-800 text-sm font-medium" onclick="event.stopPropagation(); openModal('modal-4')">
              üìñ Lire plus
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Post 5 -->
    <div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer" onclick="openModal('modal-5')">
      <div class="flex gap-4">
        <div class="w-24 h-24 bg-yellow-100 dark:bg-yellow-900 rounded-lg flex items-center justify-center flex-shrink-0">
          <span class="text-3xl">üöå</span>
        </div>
        <div class="flex-1">
          <div class="flex justify-between items-start mb-2">
            <span class="bg-yellow-500 text-white px-2 py-1 rounded text-xs">Transport</span>
            <span class="text-sm text-gray-500 dark:text-gray-400">Il y a 1j</span>
          </div>
          <h3 class="font-bold text-lg mb-1 text-gray-900 dark:text-gray-100">Nouvelles Lignes de Bus</h3>
          <p class="text-gray-600 dark:text-gray-400 text-sm mb-2">Trois nouvelles lignes pour am√©liorer la desserte...</p>
          <div class="flex justify-between items-center">
            <span class="text-xs text-gray-500 dark:text-gray-400">Par Transports Info</span>
            <button class="text-blue-600 hover:text-blue-800 text-sm font-medium" onclick="event.stopPropagation(); openModal('modal-5')">
              üìñ Lire plus
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Post 6 -->
    <div class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer" onclick="openModal('modal-6')">
      <div class="flex gap-4">
        <div class="w-24 h-24 bg-indigo-100 dark:bg-indigo-900 rounded-lg flex items-center justify-center flex-shrink-0">
          <span class="text-3xl">üè•</span>
        </div>
        <div class="flex-1">
          <div class="flex justify-between items-start mb-2">
            <span class="bg-indigo-500 text-white px-2 py-1 rounded text-xs">Sant√©</span>
            <span class="text-sm text-gray-500 dark:text-gray-400">Il y a 2j</span>
          </div>
          <h3 class="font-bold text-lg mb-1 text-gray-900 dark:text-gray-100">Campagne de Vaccination</h3>
          <p class="text-gray-600 dark:text-gray-400 text-sm mb-2">Nouvelle campagne de pr√©vention au centre m√©dical...</p>
          <div class="flex justify-between items-center">
            <span class="text-xs text-gray-500 dark:text-gray-400">Par Sant√© Publique</span>
            <button class="text-blue-600 hover:text-blue-800 text-sm font-medium" onclick="event.stopPropagation(); openModal('modal-6')">
              üìñ Lire plus
            </button>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>

<!-- Detail Modal -->
<div id="detail-modal" class="fixed inset-0 z-50 hidden items-center justify-center bg-black bg-opacity-50">
  <div class="bg-white dark:bg-gray-800 max-w-3xl w-full mx-4 rounded-lg overflow-hidden max-h-[80vh] overflow-y-auto">
    <div class="p-6">
      <!-- Modal Header -->
      <div class="flex justify-between items-start mb-6">
        <div id="modal-category" class="bg-blue-500 text-white px-4 py-2 rounded-full text-sm font-medium"></div>
        <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 text-2xl font-bold">√ó</button>
      </div>
      
      <!-- Modal Content -->
      <div class="flex gap-6 mb-6">
        <div id="modal-image" class="w-32 h-32 bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center flex-shrink-0">
          <span id="modal-emoji" class="text-4xl"></span>
        </div>
        <div class="flex-1">
          <h2 id="modal-title" class="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-4"></h2>
          <div class="flex justify-between items-center mb-4">
            <div id="modal-author" class="text-gray-600 dark:text-gray-400"></div>
            <div id="modal-time" class="text-sm text-gray-500 dark:text-gray-400"></div>
          </div>
        </div>
      </div>
      
      <!-- Article Content -->
      <div class="mb-6">
        <div id="modal-content" class="text-gray-600 dark:text-gray-400 space-y-4 leading-relaxed"></div>
      </div>
      
      <!-- Share & Comment Form -->
      <div class="border-t dark:border-gray-600 pt-6">
        <h3 class="text-lg font-bold text-gray-900 dark:text-gray-100 mb-4">R√©agir √† cet article</h3>
        <form class="space-y-4" onsubmit="handleCommentSubmit(event)">
          <div>
            <label class="block text-gray-700 dark:text-gray-300 font-medium mb-2"><%= t('forms.your_name') %></label>
            <input type="text" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-lg focus:border-blue-500 focus:outline-none" placeholder="<%= t('common.your_full_name') %>" required>
          </div>
          <div>
            <label class="block text-gray-700 dark:text-gray-300 font-medium mb-2"><%= t('forms.comment') %></label>
            <textarea rows="4" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-gray-100 rounded-lg focus:border-blue-500 focus:outline-none resize-none" placeholder="<%= t('common.your_comment') %>" required></textarea>
          </div>
          <div class="flex gap-4 pt-4">
            <button type="submit" class="bg-blue-500 hover:bg-blue-600 text-white flex-1 py-3 px-6 rounded-lg font-semibold">
              üí¨ <%= t('actions.publish_comment') %>
            </button>
            <button type="button" onclick="closeModal()" class="bg-gray-500 hover:bg-gray-600 text-white py-3 px-6 rounded-lg font-semibold">
              <%= t('actions.close') %>
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<script>
// Modal data for posts
const modalData = {
  'modal-1': {
    category: 'Actualit√©s',
    title: 'R√©novation de la Place Centrale',
    author: 'Par Mairie Locale',
    time: 'Il y a 3h',
    emoji: 'üèõÔ∏è',
    content: `
      <p>La municipalit√© a annonc√© le d√©but des travaux de r√©am√©nagement de la Place Centrale pour lundi prochain. Ce projet d'envergure, budg√©t√© √† 2,5 millions d'euros, transformera compl√®tement l'aspect de notre centre-ville.</p>
      <p><strong>Les principales am√©liorations :</strong></p>
      <ul class="list-disc ml-5">
        <li>Cr√©ation d'espaces verts avec plantations d'arbres et massifs fleuris</li>
        <li>Installation de nouveaux bancs et mobilier urbain moderne</li>
        <li>R√©fection compl√®te du rev√™tement avec mat√©riaux durables</li>
        <li>Am√©lioration de l'√©clairage public LED</li>
        <li>Zone d√©di√©e aux √©v√©nements communautaires</li>
      </ul>
      <p>Les travaux s'√©taleront sur 4 mois avec des d√©viations temporaires pour les transports en commun. Les commer√ßants seront accompagn√©s pendant cette p√©riode de transition.</p>
    `
  },
  'modal-2': {
    category: 'Environnement',
    title: 'Nouveau Parc √âcologique Inaugur√©',
    author: 'Par Eco Reporter',
    time: 'Il y a 5h',
    emoji: 'üå±',
    content: `
      <p>Un magnifique parc √©cologique de 3 hectares a √©t√© inaugur√© ce matin par le maire en pr√©sence de nombreux habitants. Ce projet pilote s'inscrit dans la d√©marche environnementale de la ville.</p>
      <p><strong>Les caract√©ristiques du parc :</strong></p>
      <ul class="list-disc ml-5">
        <li>Sentiers de promenade en mat√©riaux recycl√©s</li>
        <li>Zone de compostage collectif pour les r√©sidents</li>
        <li>Jardin p√©dagogique pour les √©coles locales</li>
        <li>Observatoire pour la faune locale</li>
        <li>Aires de pique-nique √©co-responsables</li>
      </ul>
      <p>Le parc est ouvert tous les jours de 7h √† 20h. Des visites guid√©es seront organis√©es les weekends pour sensibiliser √† la biodiversit√© urbaine.</p>
    `
  },
  'modal-3': {
    category: 'Culture',
    title: 'Festival de Th√©√¢tre ce Weekend',
    author: 'Par Culture Mag',
    time: 'Il y a 8h',
    emoji: 'üé≠',
    content: `
      <p>Le Festival de Th√©√¢tre Amateur se d√©roulera ce weekend avec cinq troupes locales qui pr√©senteront leurs cr√©ations originales. Un √©v√©nement culturel majeur pour notre r√©gion.</p>
      <p><strong>Programme du festival :</strong></p>
      <ul class="list-disc ml-5">
        <li>Samedi 14h : "Les Voix du Temps" - Troupe Th√©√¢trale Local</li>
        <li>Samedi 16h30 : "Rires en Cascade" - Les Com√©diens Unis</li>
        <li>Samedi 19h : "Drame en Trois Actes" - Sc√®ne Ouverte</li>
        <li>Dimanche 14h : "Contes Modernes" - Jeune Th√©√¢tre</li>
        <li>Dimanche 16h30 : "Improvisation Live" - Les Spontan√©s</li>
      </ul>
      <p>Entr√©e libre pour tous les spectacles. Buvette et restauration sur place. R√©servation recommand√©e au 05 12 34 56 78.</p>
    `
  },
  'modal-4': {
    category: 'Sports',
    title: 'Victoire de l\'√âquipe Locale',
    author: 'Par Sports News',
    time: 'Il y a 12h',
    emoji: '‚öΩ',
    content: `
      <p>Le FC Local a remport√© hier soir le championnat d√©partemental apr√®s une saison exceptionnelle. Cette victoire historique qualifie l'√©quipe pour les phases r√©gionales.</p>
      <p><strong>R√©sultats de la finale :</strong></p>
      <ul class="list-disc ml-5">
        <li>FC Local 3 - 1 AS Rival</li>
        <li>Buts marqu√©s par Martin (15'), Dupont (34'), Thomas (67')</li>
        <li>Plus de 800 supporters pr√©sents</li>
        <li>Meilleure attaque du championnat avec 89 buts</li>
        <li>S√©rie de 12 victoires cons√©cutives</li>
      </ul>
      <p>Une r√©ception officielle aura lieu vendredi en mairie pour f√©liciter les joueurs et l'encadrement technique. La ville √©tudie des investissements pour moderniser le stade.</p>
    `
  },
  'modal-5': {
    category: 'Transport',
    title: 'Nouvelles Lignes de Bus',
    author: 'Par Transports Info',
    time: 'Il y a 1j',
    emoji: 'üöå',
    content: `
      <p>Trois nouvelles lignes de bus entreront en service lundi pour am√©liorer la desserte des quartiers p√©riph√©riques. Cette extension r√©pond aux demandes des habitants.</p>
      <p><strong>Les nouvelles lignes :</strong></p>
      <ul class="list-disc ml-5">
        <li>Ligne 15 : Centre-ville ‚Üî Zone Industrielle (toutes les 20min)</li>
        <li>Ligne 16 : Gare ‚Üî Nouveau Lotissement (toutes les 30min)</li>
        <li>Ligne 17 : H√¥pital ‚Üî Campus Universitaire (toutes les 15min)</li>
        <li>Horaires √©tendus jusqu'√† 22h en semaine</li>
        <li>Service le dimanche apr√®s-midi</li>
      </ul>
      <p>Les tarifs restent inchang√©s. Distribution gratuite de plans des nouvelles lignes dans tous les arr√™ts et en mairie.</p>
    `
  },
  'modal-6': {
    category: 'Sant√©',
    title: 'Campagne de Vaccination',
    author: 'Par Sant√© Publique',
    time: 'Il y a 2j',
    emoji: 'üè•',
    content: `
      <p>Une nouvelle campagne de vaccination pr√©ventive d√©bute au centre m√©dical municipal. Cette initiative gratuite vise √† renforcer la couverture vaccinale de la population.</p>
      <p><strong>Vaccinations propos√©es :</strong></p>
      <ul class="list-disc ml-5">
        <li>Rappels DTP (Dipht√©rie, T√©tanos, Poliomy√©lite)</li>
        <li>Vaccin contre la grippe saisonni√®re</li>
        <li>Vaccination COVID-19 et rappels</li>
        <li>H√©patite B pour les professionnels expos√©s</li>
        <li>Vaccins voyageurs sur demande</li>
      </ul>
      <p>Rendez-vous du lundi au vendredi de 8h √† 18h. Inscription obligatoire au 05 23 45 67 89 ou en ligne. Apporter carnet de vaccination et pi√®ce d'identit√©.</p>
    `
  }
};

// Modal functions
function openModal(modalId) {
  const data = modalData[modalId];
  if (data) {
    document.getElementById('modal-category').textContent = data.category;
    document.getElementById('modal-title').textContent = data.title;
    document.getElementById('modal-author').textContent = data.author;
    document.getElementById('modal-time').textContent = data.time;
    document.getElementById('modal-emoji').textContent = data.emoji;
    document.getElementById('modal-content').innerHTML = data.content;
    
    // Set category color based on type
    const categoryElement = document.getElementById('modal-category');
    const categoryColors = {
      'Actualit√©s': 'bg-blue-500',
      'Environnement': 'bg-green-500',
      'Culture': 'bg-purple-500',
      'Sports': 'bg-red-500',
      'Transport': 'bg-yellow-500',
      'Sant√©': 'bg-indigo-500'
    };
    
    // Reset classes and add appropriate color
    categoryElement.className = `text-white px-4 py-2 rounded-full text-sm font-medium ${categoryColors[data.category] || 'bg-blue-500'}`;
    
    document.getElementById('detail-modal').style.display = 'flex';
    document.getElementById('detail-modal').classList.remove('hidden');
  }
}

function closeModal() {
  document.getElementById('detail-modal').style.display = 'none';
  document.getElementById('detail-modal').classList.add('hidden');
}

function handleCommentSubmit(event) {
  event.preventDefault();
  alert('Commentaire publi√©! Merci pour votre participation.');
  closeModal();
}

// Close modal when clicking outside
document.getElementById('detail-modal').addEventListener('click', function(e) {
  if (e.target === document.getElementById('detail-modal')) {
    closeModal();
  }
});
</script>